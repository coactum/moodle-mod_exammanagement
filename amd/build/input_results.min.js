define("mod_exammanagement/input_results",["exports","jquery"],(function(_exports,_jquery){var obj;
/**
   * Tracking changes of input fields, changing focus and checking matrnr.
   *
   * @module      mod_exammanagement/input_results
   * @copyright   2022 coactum GmbH
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};_exports.init=lang=>{(0,_jquery.default)("#id_matrnr").val()&&(0,_jquery.default)("#id_matrnr").prop("disabled",!0),(0,_jquery.default)("form.mform input[type=text]:not(#id_matrnr)").attr("type","number");(0,_jquery.default)(".tasksarea input[type=number]:not(#id_matrnr)").css({"-webkit-appearance":"textfield","-moz-appearance":"textfield",margin:"0px",width:"70px"}),(0,_jquery.default)(".tasksarea input[type=number]:not(#id_matrnr)").attr("step","0.01"),(0,_jquery.default)(".tasksarea nput[type=number]:not(#id_matrnr)").attr("min","0"),(0,_jquery.default)(".exammanagement_task_spacing .form-group div").removeClass("col-md-3"),(0,_jquery.default)(".exammanagement_task_spacing .form-group div").removeClass("col-md-9"),(0,_jquery.default)(".exammanagement_task_spacing .form-group").removeClass("row"),(0,_jquery.default)(".tasksarea input[type=number]:not(#id_matrnr)").each((function(){(0,_jquery.default)(this).attr("max",parseFloat((0,_jquery.default)("#max_points_"+getInputId((0,_jquery.default)(this))).text().replace(/,/g,".")))})),(0,_jquery.default)("form.mform .form-group input.checkboxgroup1").each((function(){(0,_jquery.default)(this).prop("checked")&&(0,_jquery.default)("form.mform .form-group input.form-control").each((function(){"matrnr"!=getInputId((0,_jquery.default)(this))&&(0,_jquery.default)(this).prop("disabled",!0)}))})),(0,_jquery.default)("#totalpoints").text(getTotalpoints(lang)),(0,_jquery.default)("form.mform :checkbox").change((function(){var checked=!1,changedId=(0,_jquery.default)(this).prop("id");(0,_jquery.default)("form.mform .form-group input.checkboxgroup1").each((function(){(0,_jquery.default)(this).prop("checked")&&(checked=!0)})),checked?("id_state_nt"==changedId?((0,_jquery.default)("#id_state_fa").prop("checked",!1),(0,_jquery.default)("#id_state_ill").prop("checked",!1)):"id_state_fa"==changedId?((0,_jquery.default)("#id_state_nt").prop("checked",!1),(0,_jquery.default)("#id_state_ill").prop("checked",!1)):"id_state_ill"==changedId&&((0,_jquery.default)("#id_state_nt").prop("checked",!1),(0,_jquery.default)("#id_state_fa").prop("checked",!1)),(0,_jquery.default)("form.mform .form-group input.form-control").each((function(){"matrnr"!=getInputId((0,_jquery.default)(this))&&((0,_jquery.default)(this).prop("disabled",!0),(0,_jquery.default)(this).val(0))}))):(0,_jquery.default)("form.mform .form-group input.form-control").each((function(){"matrnr"!=getInputId((0,_jquery.default)(this))&&(0,_jquery.default)(this).prop("disabled",!1)}))})),(0,_jquery.default)("form.mform .form-group").on("change","input",(function(){(0,_jquery.default)("#totalpoints").text(getTotalpoints(lang))})),(0,_jquery.default)("#id_matrnr").change((function(){var matrnr=(0,_jquery.default)(this).val(),id=getUrlParameter("id");matrnr.match(/^\d+$/)?location.href="inputResults.php?id="+id+"&matrnr="+matrnr:((0,_jquery.default)(this).val(""),require(["core/notification"],(function(notification){notification.addNotification({message:invalidMatrnrFormatStr,type:"error"})})))})),1==(0,_jquery.default)("input[name='matrval']").val()?(0,_jquery.default)("#id_matrnr").focus():(0,_jquery.default)("#id_points_1").focus(),(0,_jquery.default)("#id_submitbutton").click((function(){(0,_jquery.default)("#id_matrnr").prop("disabled",!1)}));var lastpointsfield=(0,_jquery.default)('input[name="lastkeypoints"]').val();(0,_jquery.default)('form.mform input[name^="points["]').keypress((function(e){if(13==e.which||3==e.which){var name=(0,_jquery.default)(this).attr("name"),newfieldnumber=parseInt(name.match(/\d+/))+1;e.preventDefault(),(0,_jquery.default)('input[name="points['+newfieldnumber+']"]').focus()}})),(0,_jquery.default)('input[name="points['+lastpointsfield+']"]').keydown((function(e){if(9==e.which||13==e.which||3==e.which)return(0,_jquery.default)("#id_matrnr").prop("disabled",!1),(0,_jquery.default)("form.mform").submit(),!1}))};var invalidMatrnrFormatStr=!1;require(["core/str"],(function(str){str.get_strings([{key:"invalid_matrnr_format",component:"mod_exammanagement"},{key:"cancel",component:"mod_exammanagement"}]).then((function(results){invalidMatrnrFormatStr=results[0],(0,_jquery.default)("#id_cancel").val(results[1])}))}));var getInputId=function(element){return element.attr("id").split("_").pop()},getTotalpoints=function(lang){var totalpoints=0;return(0,_jquery.default)("form.mform .form-group input.form-control").each((function(){"matrnr"!=getInputId((0,_jquery.default)(this))&&(0,_jquery.default)(this).val()&&(totalpoints+=parseFloat((0,_jquery.default)(this).val()))})),totalpoints=totalpoints.toLocaleString(lang)},getUrlParameter=function(sParam){var sParameterName,i,sURLVariables=decodeURIComponent(window.location.search.substring(1)).split("&");for(i=0;i<sURLVariables.length;i++)if((sParameterName=sURLVariables[i].split("="))[0]===sParam)return void 0===sParameterName[1]||sParameterName[1]}}));

//# sourceMappingURL=input_results.min.js.map