{"version":3,"sources":["../src/participants_overview.js"],"names":["define","$","getTotalpoints","lang","totalpoints","not","each","isNaN","parseFloat","val","toLocaleString","getTotalpointsWithBonus","totalpointsWithBonus","init","tasks","attr","css","count","prop","id","posPoint","children","hide","indexOf","substr","show","change","text","on","removeClass","addClass","click"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * functions for participants overview page\n *\n * @module      mod_exammanagement/import_bonus\n * @copyright   coactum GmbH 2019\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function ($) {\n\n  var getTotalpoints = function (lang) {\n    var totalpoints = 0;\n\n    $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () {\n      if (!isNaN(parseFloat($(this).val()))){\n        totalpoints += parseFloat($(this).val());\n      }\n    });\n\n    return totalpoints.toLocaleString(lang);\n  };\n\n  var getTotalpointsWithBonus = function (lang) {\n\n    var totalpointsWithBonus = parseFloat(getTotalpoints('en'));\n\n    if(!isNaN(parseFloat($(\"#id_bonuspoints\").val()))){\n      totalpointsWithBonus +=  parseFloat($(\"#id_bonuspoints\").val());\n    }\n\n    return totalpointsWithBonus.toLocaleString(lang);\n  };\n\n  return {\n    init: function (lang, tasks) {\n\n      // create input type number elements\n      $(\"form.mform input[type=text]\").not('#id_room, #id_place').attr(\"type\", \"number\");\n\n      var styles = {\n        \"-webkit-appearance\": \"textfield\",\n        \"-moz-appearance\": \"textfield\",\n        \"margin-left\": \"10px\",\n        \"width\": \"65px\"\n      };\n\n      $(\"form.mform input[type=number]\").css(styles);\n      $(\"form.mform input[type=number]\").attr(\"step\", \"0.01\");\n      $(\"form.mform input[type=number]\").attr(\"min\", \"0\");\n\n      var count = 1;\n      $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () {\n        $(this).attr(\"max\", tasks[count]); // set maximum points for tasks\n        count += 1;\n\n        if ($(\"#id_state\").val() !== 'normal') {\n          $(this).prop(\"disabled\", true); //initial disabling point fields if examstate is not normal\n        }\n      });\n\n      var id;\n      var posPoint;\n\n      // show available places pattern\n      id = $(\"#id_room\").children(\":selected\").attr(\"value\");\n\n      $(\".hiddenpattern\").each(function () { // for removing the initial set hidden class\n        $(this).prop(\"class\", 'hideablepattern');\n      });\n\n      $(\".hideablepattern\").each(function () {\n        $(this).hide(); // hide old places pattern\n      });\n\n      if(id){\n        posPoint = id.indexOf('.'); // make room ids with . working\n\n        if (posPoint !== -1) {\n          id = id.substr(0, posPoint) + '\\\\' + id.substr(posPoint);\n        }\n\n        $('#' + id).show(); // make correct pattern for places visible\n      }\n\n      // if exam bonus steps change\n      $(\"#id_bonussteps\").change(function () {\n        if ($(\"#id_bonussteps\").val() !== '-'){\n          $(\"#id_bonuspoints\").val('-');  // reset bonus points\n          $(\"#id_bonuspoints\").prop(\"disabled\", true); // disable bonuspoints\n        } else {\n          $(\"#id_bonuspoints\").prop(\"disabled\", false); // enable bonuspoints\n        }\n      });\n\n      // if exam bonus points change\n      $(\"#id_bonuspoints\").change(function () {\n        if ($(\"#id_bonuspoints\").val()){\n          $(\"#id_bonussteps\").val('-'); // reset bonus steps\n        }\n      });\n\n      //if examstate changes\n      $(\"#id_state\").change(function () {\n\n        if ($(\"#id_state\").val() !== 'normal') { // if examstate is now not normal: disable all point-fields and set their value to 0\n\n          $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () {\n            $(this).prop(\"disabled\", true);\n            $(this).val(0);\n            $(\"#totalpoints\").text($(\"#id_state option:selected\").text()); // change totalpoints\n            $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus(lang)); // change totalpoints with bonus\n\n          });\n        } else {  // if examstate is now normal\n          $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () { // enable all point-fields\n            $(this).prop(\"disabled\", false);\n          });\n          $(\"#totalpoints\").text(getTotalpoints(lang)); // change totalpoints\n          $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus(lang)); // change totalpoints with bonus\n        }\n      });\n\n      $(\"form.mform .form-group\").not(\"#fitem_id_place\").on(\"change\", \"input\", function () { // if some input field changes\n        $(\"#totalpoints\").text(getTotalpoints(lang)); // change totalpoints\n        $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus(lang)); // change totalpoints with bonus\n      });\n\n      $(\"#id_bonuspoints\").on(\"change\", \"input\", function () { // if bonus points input field changes\n        $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus(lang)); // change totalpoints with bonus\n      });\n\n      $(\"form.mform #fitem_id_room\").on(\"change\", \"select\", function () { // change available places pattern if other room is choosen\n        id = $(this).children(\":selected\").attr(\"value\");\n\n        $(\".hideablepattern\").each(function () {\n          $(this).hide(); // hide old places pattern\n        });\n\n        posPoint = id.indexOf('.'); // make room ids with . working\n\n        if (posPoint !== -1) {\n          id = id.substr(0, posPoint) + '\\\\' + id.substr(posPoint);\n        }\n\n        $('#' + id).show(); // make correct pattern for places visible\n      });\n\n      // remove cols from form layout\n      $('form.mform div').removeClass('col-md-3');\n      $('form.mform div').removeClass('col-md-9');\n\n      $('form.mform > .form-group > div:first-child').addClass('col-md-3');\n      $('form.mform  > .form-group > div:last-child').addClass('col-md-9');\n\n      $('form.mform #id_submitbutton').click(function () {  // if submittbutton is presses enable complete form (for moodle purposes)\n\n        $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () { // enable all point-fields\n          $(this).prop(\"disabled\", false);\n        });\n\n        $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () { // if some input point field has values\n          if ($(this).val()) {\n            $(\"form.mform input[name='pne']\").val(false); // set points not entered param to false\n          }\n        });\n\n        if($('#id_bonuspoints').val()){\n          $(\"form.mform input[name='bpne']\").val(false); // set bonus points not entered param to false\n        }\n\n      });\n    }\n  };\n});\n"],"file":"participants_overview.min.js"}