{"version":3,"sources":["../src/participants_overview.js"],"names":["define","$","getTotalpoints","totalpoints","not","each","val","parseFloat","replace","toFixed","getTotalpointsWithBonus","totalpointsWithBonus","init","attr","css","prop","id","posPoint","children","hide","indexOf","substr","show","change","text","on","removeClass","addClass","click"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * functions for participants overview page\n *\n * @module      mod_exammanagement/import_bonus\n * @copyright   coactum GmbH 2019\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function ($) {\n\n  var getTotalpoints = function () {\n    var totalpoints = 0;\n\n    $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () {\n      if ($(this).val() != '-') {\n        totalpoints += parseFloat($(this).val().replace(',', '.'));\n      }\n    });\n\n    return String(totalpoints.toFixed(2)).replace('.', ',');\n  };\n\n  var getTotalpointsWithBonus = function () {\n    var totalpointsWithBonus = 0;\n\n    if($(\"#id_bonuspoints\").val() != '-' && getTotalpoints() != 0){\n      totalpointsWithBonus = Number(getTotalpoints().replace(',', '.')) + parseFloat($(\"#id_bonuspoints\").val().replace(',', '.'));\n    }\n\n    return String(totalpointsWithBonus.toFixed(2)).replace('.', ',');\n  };\n\n  return {\n    init: function () {\n\n      // create input type number elements\n      $(\"form.mform input[type=text]\").not('#id_room, #id_place').attr(\"type\", \"number\");\n\n      var styles = {\n        \"-webkit-appearance\": \"textfield\",\n        \"-moz-appearance\": \"textfield\",\n        \"margin-left\": \"10px\",\n        \"width\": \"65px\"\n      };\n\n      $(\"form.mform input[type=number]\").css(styles);\n      $(\"form.mform input[type=number]\").attr(\"step\", \"0.01\");\n      $(\"form.mform input[type=number]\").attr(\"min\", \"0\");\n\n      // initial disabling point fields if examstate is not normal\n      if ($(\"#id_state\").val() !== 'normal') {\n        $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () {\n          $(this).prop(\"disabled\", true);\n        });\n      }\n\n      var id;\n      var posPoint;\n\n      // show available places pattern\n      id = $(\"#id_room\").children(\":selected\").attr(\"value\");\n\n      $(\".hiddenpattern\").each(function () { // for removing the initial set hidden class\n        $(this).prop(\"class\", 'hideablepattern');\n      });\n\n      $(\".hideablepattern\").each(function () {\n        $(this).hide(); // hide old places pattern\n      });\n\n      if(id){\n        posPoint = id.indexOf('.'); // make room ids with . working\n\n        if (posPoint !== -1) {\n          id = id.substr(0, posPoint) + '\\\\' + id.substr(posPoint);\n        }\n\n        $('#' + id).show(); // make correct pattern for places visible\n      }\n\n      //if examstate changes\n      $(\"#id_state\").change(function () {\n\n        if ($(\"#id_state\").val() !== 'normal') { // if examstate is now not normal: disable all point-fields and set their value to 0\n\n          $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () {\n            $(this).prop(\"disabled\", true);\n            $(this).val(0);\n            $(\"#totalpoints\").text($(\"#id_state option:selected\").text()); // change totalpoints\n            $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus()); // change totalpoints with bonus\n\n          });\n        } else {  // if examstate is now normal\n          $(\"form.mform .form-group input.form-control\").not(\"#id_place, #id_bonuspoints\").each(function () { // enable all point-fields\n            $(this).prop(\"disabled\", false);\n          });\n          $(\"#totalpoints\").text(getTotalpoints()); // change totalpoints\n          $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus()); // change totalpoints with bonus\n        }\n      });\n\n      $(\"form.mform .form-group\").not(\"#fitem_id_place\").on(\"change\", \"input\", function () { // if some input field changes\n        $(\"#totalpoints\").text(getTotalpoints()); // change totalpoints\n        $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus()); // change totalpoints with bonus\n      });\n\n      $(\"#id_bonuspoints\").on(\"change\", \"input\", function () { // if bonus points input field changes\n        $(\"#totalpoints_with_bonus\").text(getTotalpointsWithBonus()); // change totalpoints with bonus\n      });\n\n      $(\"form.mform #fitem_id_room\").on(\"change\", \"select\", function () { // change available places pattern if other room is choosen\n        id = $(this).children(\":selected\").attr(\"value\");\n\n        $(\".hideablepattern\").each(function () {\n          $(this).hide(); // hide old places pattern\n        });\n\n        posPoint = id.indexOf('.'); // make room ids with . working\n\n        if (posPoint !== -1) {\n          id = id.substr(0, posPoint) + '\\\\' + id.substr(posPoint);\n        }\n\n        $('#' + id).show(); // make correct pattern for places visible\n      });\n\n      // remove cols from form layout\n      $('form.mform div').removeClass('col-md-3');\n      $('form.mform div').removeClass('col-md-9');\n\n      $('form.mform > .form-group > div:first-child').addClass('col-md-3');\n      $('form.mform  > .form-group > div:last-child').addClass('col-md-9');\n\n      $('form.mform #id_submitbutton').click(function () {  // if submittbutton is presses enable complete form (for moodle purposes)\n\n        $(\"form.mform .form-group input.form-control\").not(\"#id_place\").each(function () { // enable all point-fields\n          $(this).prop(\"disabled\", false);\n        });\n\n        $(\"form.mform .form-group input.form-control\").not(\"#id_place\").each(function () { // if some input point field has values\n          if ($(this).val()) {\n            $(\"form.mform input[name='pne']\").val(false); // set points not entered param to false\n          }\n        });\n\n      });\n    }\n  };\n});\n"],"file":"participants_overview.min.js"}