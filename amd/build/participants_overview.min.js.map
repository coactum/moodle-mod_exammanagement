{"version":3,"file":"participants_overview.min.js","sources":["../src/participants_overview.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Participants overview page.\n *\n * @module      mod_exammanagement/import_bonus\n * @copyright   2022 coactum GmbH\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nexport const init = (tasks) => {\n\n  // Create input type number elements.\n  $(\"form.mform input[type=text]\").attr(\"type\", \"number\");\n\n  var styles = {\n    \"-webkit-appearance\": \"textfield\",\n    \"-moz-appearance\": \"textfield\",\n    \"margin-left\": \"10px\",\n    \"width\": \"70px\"\n  };\n\n  $(\"form.mform input[type=number]\").css(styles);\n  $(\"form.mform input[type=number]\").attr(\"step\", \"0.01\");\n  $(\"form.mform input[type=number]\").attr(\"min\", \"0\");\n\n  if ($(\"[id^=id_points]\").length !== 0) {\n    $(\"[id^=id_points]\").first().focus();\n  } else {\n    $(\"[id^=id_bonuspoints]\").first().focus();\n  }\n\n  $(\"[id^=id_points]\").each(function() {\n\n    var participantid = $(this).attr(\"id\").split('_')[2];\n    var count = $(this).attr(\"id\").split('_')[3];\n\n    $(this).attr(\"max\", tasks[count]); // Set maximum points for tasks.\n\n    if ($(\"#id_state_\" + participantid).val() !== 'normal' && $(\"#id_state_\" + participantid).val() !== 'not_set') {\n      $(this).prop(\"disabled\", true); // Initial disabling point fields if examstate is not normal or not set.\n    }\n  });\n\n  $(\"[id^=id_bonuspoints]\").each(function() {\n\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(\"#id_bonussteps_\" + participantid).val() && $(\"#id_bonussteps_\" + participantid).val() !== '-') {\n      $(this).prop(\"disabled\", true); // Initial disabling bonuspoint fields if bonusstep is set.\n    }\n  });\n\n  // If exam bonus steps change.\n  $(\"[id^=id_bonussteps]\").change(function() {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(this).val() !== '-') {\n      $(\"#id_bonuspoints_\" + participantid).val('-'); // Reset bonus points.\n      $(\"#id_bonuspoints_\" + participantid).prop(\"disabled\", true); // Disable bonuspoints.\n    } else {\n      $(\"#id_bonuspoints_\" + participantid).prop(\"disabled\", false); // Enable bonuspoints.\n    }\n\n    $(\"#id_state_\" + participantid).focus(); // Move focus.\n\n    $('input[name=\"bonuspoints_entered[' + participantid + ']\"]').val(0); // Set bonuspoints entered to true.\n  });\n\n  // If exam bonus points change.\n  $(\"[id^=id_bonuspoints]\").change(function() {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(this).val()) {\n      $(\"#id_bonussteps_\" + participantid).val('-'); // Reset bonus steps.\n      $(\"#id_state_\" + participantid).focus(); // Move focus.\n      $('input[name=\"bonuspoints_entered[' + participantid + ']\"]').val(1); // Set bonuspoints entered to true.\n    }\n  });\n\n  // If exam points are entered.\n  $(\"[id^=id_points]\").change(function() {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n    $(\"#id_state_\" + participantid).val('normal');\n  });\n\n  // If examstate changes.\n  $(\"[id^=id_state]\").change(function() {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    // If examstate is now not normal or not set: disable all point-fields and set their value to 0.\n    if ($(this).val() !== 'normal' && $(this).val() !== 'not_set') {\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function() {\n        $(this).prop(\"disabled\", true);\n        $(this).val(0);\n      });\n    } else if ($(this).val() === 'normal') { // If examstate is now normal.\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function() { // Enable all point fields.\n        $(this).prop(\"disabled\", false);\n        $(\"[id^=id_points_\" + participantid + \"\").first().focus();\n      });\n    } else if ($(this).val() == 'not_set') {\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function() { // Enable all point fields.\n        $(this).val('');\n        $(this).prop(\"disabled\", false);\n        $(\"[id^=id_points_\" + participantid + \"\").first().focus();\n      });\n    }\n  });\n\n  // Remove cols from form layout.\n  $('.exammanagement_table div').removeClass('col-md-3');\n  $('.exammanagement_table div').removeClass('col-md-9');\n\n  $('form.mform #id_submitbutton').click(function() { // If submittbutton is pressed enable complete form (for moodle purposes).\n\n    $(\"form.mform .form-group input.form-control\").not(\"[id^=id_bonuspoints]\").each(function() { // Enable all point fields.\n      $(this).prop(\"disabled\", false);\n    });\n  });\n};\n"],"names":["obj","_jquery","__esModule","default","_exports","init","tasks","$","attr","css","width","length","first","focus","each","participantid","this","split","count","val","prop","change","removeClass","click","not"],"mappings":"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"}