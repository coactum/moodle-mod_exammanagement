{"version":3,"sources":["../src/participants_overview.js"],"names":["init","tasks","attr","css","length","first","focus","each","participantid","split","count","val","prop","change","removeClass","click","not"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Participants overview page.\n *\n * @module      mod_exammanagement/import_bonus\n * @copyright   2022 coactum GmbH\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nexport const init = (tasks) => {\n\n  // Create input type number elements.\n  $(\"form.mform input[type=text]\").attr(\"type\", \"number\");\n\n  var styles = {\n    \"-webkit-appearance\": \"textfield\",\n    \"-moz-appearance\": \"textfield\",\n    \"margin-left\": \"10px\",\n    \"width\": \"70px\"\n  };\n\n  $(\"form.mform input[type=number]\").css(styles);\n  $(\"form.mform input[type=number]\").attr(\"step\", \"0.01\");\n  $(\"form.mform input[type=number]\").attr(\"min\", \"0\");\n\n  if ($(\"[id^=id_points]\").length !== 0) {\n    $(\"[id^=id_points]\").first().focus();\n  } else {\n    $(\"[id^=id_bonuspoints]\").first().focus();\n  }\n\n  $(\"[id^=id_points]\").each(function () {\n\n    var participantid = $(this).attr(\"id\").split('_')[2];\n    var count = $(this).attr(\"id\").split('_')[3];\n\n    $(this).attr(\"max\", tasks[count]); // set maximum points for tasks\n\n    if ($(\"#id_state_\" + participantid).val() !== 'normal' && $(\"#id_state_\" + participantid).val() !== 'not_set') {\n      $(this).prop(\"disabled\", true); //initial disabling point fields if examstate is not normal or not set\n    }\n  });\n\n  $(\"[id^=id_bonuspoints]\").each(function () {\n\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(\"#id_bonussteps_\" + participantid).val() && $(\"#id_bonussteps_\" + participantid).val() !== '-') {\n      $(this).prop(\"disabled\", true); //initial disabling bonuspoint fields if bonusstep is set\n    }\n  });\n\n  // if exam bonus steps change\n  $(\"[id^=id_bonussteps]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(this).val() !== '-') {\n      $(\"#id_bonuspoints_\" + participantid).val('-');  // reset bonus points\n      $(\"#id_bonuspoints_\" + participantid).prop(\"disabled\", true); // disable bonuspoints\n    } else {\n      $(\"#id_bonuspoints_\" + participantid).prop(\"disabled\", false); // enable bonuspoints\n    }\n\n    $(\"#id_state_\" + participantid).focus(); // move focus\n\n    $('input[name=\"bonuspoints_entered[' + participantid + ']\"]').val(0);  // set bonuspoints entered to true\n  });\n\n  // if exam bonus points change\n  $(\"[id^=id_bonuspoints]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(this).val()) {\n      $(\"#id_bonussteps_\" + participantid).val('-'); // reset bonus steps\n      $(\"#id_state_\" + participantid).focus(); // move focus\n      $('input[name=\"bonuspoints_entered[' + participantid + ']\"]').val(1);  // set bonuspoints entered to true\n    }\n  });\n\n  // if exam points are entered\n  $(\"[id^=id_points]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n    $(\"#id_state_\" + participantid).val('normal');\n  });\n\n  // if examstate changes\n  $(\"[id^=id_state]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    // If examstate is now not normal or not set: disable all point-fields and set their value to 0.\n    if ($(this).val() !== 'normal' && $(this).val() !== 'not_set') {\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function () {\n        $(this).prop(\"disabled\", true);\n        $(this).val(0);\n      });\n    } else if ($(this).val() === 'normal') {  // if examstate is now normal\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function () { // enable all point-fields\n        $(this).prop(\"disabled\", false);\n        $(\"[id^=id_points_\" + participantid + \"\").first().focus();\n      });\n    } else if ($(this).val() == 'not_set') {\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function () { // enable all point-fields\n        $(this).val('');\n        $(this).prop(\"disabled\", false);\n        $(\"[id^=id_points_\" + participantid + \"\").first().focus();\n      });\n    }\n  });\n\n  // remove cols from form layout\n  $('.exammanagement_table div').removeClass('col-md-3');\n  $('.exammanagement_table div').removeClass('col-md-9');\n\n  $('form.mform #id_submitbutton').click(function () {  // if submittbutton is pressed enable complete form (for moodle purposes)\n\n    $(\"form.mform .form-group input.form-control\").not(\"[id^=id_bonuspoints]\").each(function () { // enable all point-fields\n      $(this).prop(\"disabled\", false);\n    });\n  });\n};\n"],"file":"participants_overview.min.js"}