{"version":3,"file":"participants_overview.min.js","sources":["../src/participants_overview.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Participants overview page.\n *\n * @module      mod_exammanagement/import_bonus\n * @copyright   2022 coactum GmbH\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nexport const init = (tasks) => {\n\n  // Create input type number elements.\n  $(\"form.mform input[type=text]\").attr(\"type\", \"number\");\n\n  var styles = {\n    \"-webkit-appearance\": \"textfield\",\n    \"-moz-appearance\": \"textfield\",\n    \"margin-left\": \"10px\",\n    \"width\": \"70px\"\n  };\n\n  $(\"form.mform input[type=number]\").css(styles);\n  $(\"form.mform input[type=number]\").attr(\"step\", \"0.01\");\n  $(\"form.mform input[type=number]\").attr(\"min\", \"0\");\n\n  if ($(\"[id^=id_points]\").length !== 0) {\n    $(\"[id^=id_points]\").first().focus();\n  } else {\n    $(\"[id^=id_bonuspoints]\").first().focus();\n  }\n\n  $(\"[id^=id_points]\").each(function () {\n\n    var participantid = $(this).attr(\"id\").split('_')[2];\n    var count = $(this).attr(\"id\").split('_')[3];\n\n    $(this).attr(\"max\", tasks[count]); // set maximum points for tasks\n\n    if ($(\"#id_state_\" + participantid).val() !== 'normal' && $(\"#id_state_\" + participantid).val() !== 'not_set') {\n      $(this).prop(\"disabled\", true); //initial disabling point fields if examstate is not normal or not set\n    }\n  });\n\n  $(\"[id^=id_bonuspoints]\").each(function () {\n\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(\"#id_bonussteps_\" + participantid).val() && $(\"#id_bonussteps_\" + participantid).val() !== '-') {\n      $(this).prop(\"disabled\", true); //initial disabling bonuspoint fields if bonusstep is set\n    }\n  });\n\n  // if exam bonus steps change\n  $(\"[id^=id_bonussteps]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(this).val() !== '-') {\n      $(\"#id_bonuspoints_\" + participantid).val('-');  // reset bonus points\n      $(\"#id_bonuspoints_\" + participantid).prop(\"disabled\", true); // disable bonuspoints\n    } else {\n      $(\"#id_bonuspoints_\" + participantid).prop(\"disabled\", false); // enable bonuspoints\n    }\n\n    $(\"#id_state_\" + participantid).focus(); // move focus\n\n    $('input[name=\"bonuspoints_entered[' + participantid + ']\"]').val(0);  // set bonuspoints entered to true\n  });\n\n  // if exam bonus points change\n  $(\"[id^=id_bonuspoints]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    if ($(this).val()) {\n      $(\"#id_bonussteps_\" + participantid).val('-'); // reset bonus steps\n      $(\"#id_state_\" + participantid).focus(); // move focus\n      $('input[name=\"bonuspoints_entered[' + participantid + ']\"]').val(1);  // set bonuspoints entered to true\n    }\n  });\n\n  // if exam points are entered\n  $(\"[id^=id_points]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n    $(\"#id_state_\" + participantid).val('normal');\n  });\n\n  // if examstate changes\n  $(\"[id^=id_state]\").change(function () {\n    var participantid = $(this).attr(\"id\").split('_')[2];\n\n    // If examstate is now not normal or not set: disable all point-fields and set their value to 0.\n    if ($(this).val() !== 'normal' && $(this).val() !== 'not_set') {\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function () {\n        $(this).prop(\"disabled\", true);\n        $(this).val(0);\n      });\n    } else if ($(this).val() === 'normal') {  // if examstate is now normal\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function () { // enable all point-fields\n        $(this).prop(\"disabled\", false);\n        $(\"[id^=id_points_\" + participantid + \"\").first().focus();\n      });\n    } else if ($(this).val() == 'not_set') {\n      $(\"[id^=id_points_\" + participantid + \"]\").each(function () { // enable all point-fields\n        $(this).val('');\n        $(this).prop(\"disabled\", false);\n        $(\"[id^=id_points_\" + participantid + \"\").first().focus();\n      });\n    }\n  });\n\n  // remove cols from form layout\n  $('.exammanagement_table div').removeClass('col-md-3');\n  $('.exammanagement_table div').removeClass('col-md-9');\n\n  $('form.mform #id_submitbutton').click(function () {  // if submittbutton is pressed enable complete form (for moodle purposes)\n\n    $(\"form.mform .form-group input.form-control\").not(\"[id^=id_bonuspoints]\").each(function () { // enable all point-fields\n      $(this).prop(\"disabled\", false);\n    });\n  });\n};\n"],"names":["tasks","attr","css","length","first","focus","each","participantid","this","split","count","val","prop","change","removeClass","click","not"],"mappings":";;;;;;;wJAyBqBA,4BAGjB,+BAA+BC,KAAK,OAAQ,8BAS5C,iCAAiCC,IAPtB,sBACW,8BACH,0BACJ,aACN,6BAIT,iCAAiCD,KAAK,OAAQ,4BAC9C,iCAAiCA,KAAK,MAAO,KAEX,KAAhC,mBAAE,mBAAmBE,2BACrB,mBAAmBC,QAAQC,4BAE3B,wBAAwBD,QAAQC,4BAGlC,mBAAmBC,MAAK,eAEpBC,eAAgB,mBAAEC,MAAMP,KAAK,MAAMQ,MAAM,KAAK,GAC9CC,OAAQ,mBAAEF,MAAMP,KAAK,MAAMQ,MAAM,KAAK,uBAExCD,MAAMP,KAAK,MAAOD,MAAMU,QAEoB,YAA1C,mBAAE,aAAeH,eAAeI,OAAgE,aAA1C,mBAAE,aAAeJ,eAAeI,2BACtFH,MAAMI,KAAK,YAAY,0BAI3B,wBAAwBN,MAAK,eAEzBC,eAAgB,mBAAEC,MAAMP,KAAK,MAAMQ,MAAM,KAAK,IAE9C,mBAAE,kBAAoBF,eAAeI,OAAwD,OAA/C,mBAAE,kBAAoBJ,eAAeI,2BACnFH,MAAMI,KAAK,YAAY,0BAK3B,uBAAuBC,QAAO,eAC1BN,eAAgB,mBAAEC,MAAMP,KAAK,MAAMQ,MAAM,KAAK,GAE5B,OAAlB,mBAAED,MAAMG,2BACR,mBAAqBJ,eAAeI,IAAI,yBACxC,mBAAqBJ,eAAeK,KAAK,YAAY,wBAErD,mBAAqBL,eAAeK,KAAK,YAAY,uBAGvD,aAAeL,eAAeF,4BAE9B,mCAAqCE,cAAgB,OAAOI,IAAI,0BAIlE,wBAAwBE,QAAO,eAC3BN,eAAgB,mBAAEC,MAAMP,KAAK,MAAMQ,MAAM,KAAK,IAE9C,mBAAED,MAAMG,4BACR,kBAAoBJ,eAAeI,IAAI,yBACvC,aAAeJ,eAAeF,4BAC9B,mCAAqCE,cAAgB,OAAOI,IAAI,2BAKpE,mBAAmBE,QAAO,eACtBN,eAAgB,mBAAEC,MAAMP,KAAK,MAAMQ,MAAM,KAAK,uBAChD,aAAeF,eAAeI,IAAI,iCAIpC,kBAAkBE,QAAO,eACrBN,eAAgB,mBAAEC,MAAMP,KAAK,MAAMQ,MAAM,KAAK,GAG5B,YAAlB,mBAAED,MAAMG,OAAwC,aAAlB,mBAAEH,MAAMG,0BACtC,kBAAoBJ,cAAgB,KAAKD,MAAK,+BAC5CE,MAAMI,KAAK,YAAY,uBACvBJ,MAAMG,IAAI,MAEa,YAAlB,mBAAEH,MAAMG,0BACf,kBAAoBJ,cAAgB,KAAKD,MAAK,+BAC5CE,MAAMI,KAAK,YAAY,uBACvB,kBAAoBL,eAAoBH,QAAQC,WAE1B,YAAjB,mBAAEG,MAAMG,2BACf,kBAAoBJ,cAAgB,KAAKD,MAAK,+BAC5CE,MAAMG,IAAI,wBACVH,MAAMI,KAAK,YAAY,uBACvB,kBAAoBL,eAAoBH,QAAQC,kCAMtD,6BAA6BS,YAAY,gCACzC,6BAA6BA,YAAY,gCAEzC,+BAA+BC,OAAM,+BAEnC,6CAA6CC,IAAI,wBAAwBV,MAAK,+BAC5EE,MAAMI,KAAK,YAAY"}