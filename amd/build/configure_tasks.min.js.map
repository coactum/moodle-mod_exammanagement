{"version":3,"file":"configure_tasks.min.js","sources":["../src/configure_tasks.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tracking changes of input fields, adding and removing tasks and creating input type number fields.\n *\n * @module      mod_exammanagement/configure_tasks\n * @copyright   2022 coactum GmbH\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nexport const init = (lang) => {\n  // Create input type number elements.\n  $(\"form.mform input[type=text]\").attr(\"type\", \"number\");\n\n  var styles = {\n    \"-webkit-appearance\": \"textfield\",\n    \"-moz-appearance\": \"textfield\",\n    \"margin\": \"0px\"\n  };\n\n  $(\"form.mform input[type=number]\").css(styles);\n  $(\"form.mform input[type=number]\").attr(\"step\", \"0.1\");\n  $(\"form.mform input[type=number]\").attr(\"min\", \"0.1\");\n  $(\"form.mform input[type=number]\").attr(\"max\", \"100\");\n\n  // Remove cols from form layout.\n  $('.exammanagement_task_spacing .form-group div').removeClass('col-md-3');\n  $('.exammanagement_task_spacing .form-group div').removeClass('col-md-9');\n  $('.exammanagement_task_spacing .form-group').removeClass('row');\n\n  $(\"form.mform .form-group\").on(\"change\", \"input\", function () { // Update total points if some field changes\n\n    var totalpoints = getTotalpoints(lang);\n    $(\"#totalpoints\").text(totalpoints);\n  });\n};\n\nexport const addtask = (lang) => { // Add new tasks.\n  $(\"#id_add_task\").click(function () {\n\n    var taskcount = getTaskCount();\n    var newtaskcount = taskcount + 1;\n    var pointsofnewtask = 10;\n\n    if (taskcount <= 99) {\n\n      var temp = '<span class=\"exammanagement_task_spacing\">';\n      temp += '<strong>' + newtaskcount + '</strong><div id=\"fitem_id_task_1\" class=\"form-group fitem femptylabel\">';\n      temp += '<div class=\"col-form-label d-flex pb-0 pr-md-0\">';\n      temp += '<div class=\"ml-1 ml-md-auto d-flex align-items-center align-self-start\"></div></div>';\n      temp += '<div class=\"form-inline align-items-start felement\" data-fieldtype=\"text\">';\n      temp += '<input type=\"number\" class=\"form-control\" name=\"task[' + newtaskcount + ']\" id=\"id_task_' + newtaskcount + '\" ';\n      temp += 'value=\"' + pointsofnewtask + '\" style=\"appearance: textfield; margin: 0px;\" step=\"0.1\" min=\"0.1\" max=\"100\">';\n      temp += '<div class=\"form-control-feedback invalid-feedback\" id=\"id_error_task_' + newtaskcount + '\">';\n      temp += '</div></div></div></span>';\n\n      $(\".mform .tasksarea\").append(temp);\n\n      var totalpoints = getTotalpoints(lang);\n      $(\"#totalpoints\").text(totalpoints);\n\n      $(\"input[name=newtaskcount]\").val(parseInt($(\"input[name=newtaskcount]\").val()) + 1);\n    }\n\n  });\n};\n\nexport const removetask = (lang) => { // Remove task.\n  $(\"#id_remove_task\").click(function () {\n\n    var taskcount = getTaskCount();\n\n    if (taskcount > 1) {\n      $(\".mform .tasksarea span:last\").remove();\n\n      var totalpoints = getTotalpoints(lang);\n      $(\"#totalpoints\").text(totalpoints);\n\n      $(\"input[name=newtaskcount]\").val(parseInt($(\"input[name=newtaskcount]\").val() - 1));\n    }\n  });\n};\n\nvar getTotalpoints = function (lang) {\n  var totalpoints = 0;\n  var newval;\n\n  $(\".form-group input.form-control\").each(function () {\n    newval = parseFloat($(this).val());\n    if (newval) {\n      totalpoints += newval;\n    }\n  });\n\n  totalpoints = totalpoints.toLocaleString(lang);\n\n  return totalpoints;\n};\n\nvar getTaskCount = function () {\n  var taskcount = 0;\n\n  $(\"form.mform .exammanagement_task_spacing\").each(function () {\n    taskcount += 1;\n  });\n\n  return taskcount;\n};\n"],"names":["lang","attr","css","removeClass","on","totalpoints","getTotalpoints","text","click","taskcount","getTaskCount","newtaskcount","temp","append","val","parseInt","remove","newval","each","parseFloat","this","toLocaleString"],"mappings":";;;;;;;6LAyBqBA,2BAEjB,+BAA+BC,KAAK,OAAQ,8BAQ5C,iCAAiCC,IANtB,sBACW,8BACH,mBACT,4BAIV,iCAAiCD,KAAK,OAAQ,2BAC9C,iCAAiCA,KAAK,MAAO,2BAC7C,iCAAiCA,KAAK,MAAO,2BAG7C,gDAAgDE,YAAY,gCAC5D,gDAAgDA,YAAY,gCAC5D,4CAA4CA,YAAY,2BAExD,0BAA0BC,GAAG,SAAU,SAAS,eAE5CC,YAAcC,eAAeN,0BAC/B,gBAAgBO,KAAKF,kCAIHL,2BACpB,gBAAgBQ,OAAM,eAElBC,UAAYC,eACZC,aAAeF,UAAY,KAG3BA,WAAa,GAAI,KAEfG,KAAO,6CACXA,MAAQ,WAAaD,aAAe,2EACpCC,MAAQ,mDACRA,MAAQ,uFACRA,MAAQ,6EACRA,MAAQ,wDAA0DD,aAAe,kBAAoBA,aAAe,KACpHC,MAAQ,yFACRA,MAAQ,yEAA2ED,aAAe,KAClGC,MAAQ,gDAEN,qBAAqBC,OAAOD,UAE1BP,YAAcC,eAAeN,0BAC/B,gBAAgBO,KAAKF,iCAErB,4BAA4BS,IAAIC,UAAS,mBAAE,4BAA4BD,OAAS,4BAM7Dd,2BACvB,mBAAmBQ,OAAM,cAETE,eAEA,EAAG,qBACf,+BAA+BM,aAE7BX,YAAcC,eAAeN,0BAC/B,gBAAgBO,KAAKF,iCAErB,4BAA4BS,IAAIC,UAAS,mBAAE,4BAA4BD,MAAQ,aAKnFR,eAAiB,SAAUN,UAEzBiB,OADAZ,YAAc,4BAGhB,kCAAkCa,MAAK,YACvCD,OAASE,YAAW,mBAAEC,MAAMN,UAE1BT,aAAeY,WAInBZ,YAAcA,YAAYgB,eAAerB,OAKvCU,aAAe,eACbD,UAAY,4BAEd,2CAA2CS,MAAK,WAChDT,WAAa,KAGRA"}